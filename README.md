# Public Key Encryption

This is an implementation of a public key encryption scheme. It uses a pseudo-random number generator to create fresh public and private keys everytime it is requested to encrypt a message. The message will be encrypted using the public key, and can only be successfully decrypted using the private key that was generated alongside the public key. There should be no instance where the encrypted text can be decrypted using a different public key. When encrypting a message, the program will prompt the user for a random seed value that they can decide for themselves (it should be an integer value). The program will then use the given seed in a pseudo random number generator in order to find a prime number. This prime number will then be used in order to create the public and private keys, which will both be written out to a text file (this was for testing purposes but can be used to distribute the public key). The public key will then be used to encrypt the message, and the ciphertext will be stored in the destination file. When decrypting, the program will take in the ciphertext file and a destination file. The program will automatically search for the private key file that it generated, and will use it in order to decrypt the ciphertext. The resulting plaintext will be stored in the destination file.

It is worth noting that new public and private keys are generated EVERY time a message is encrypted. So no two messages should ever be encrypted/decrypted with the same keys. There probably should be a case for using specific keys, but it is not part of the program's ability.

## How to use

_If not already downloaded from some other source_

`git clone https://github.com/fcphan/pub-key-crypto.git`

_Otherwise run the following_

`python3 main.py <mode> <input> <output>`

- `<mode>` can either be `encrypt` or `decrypt`. Used to tell the program if it is encrypting or decrypting the given textfile.
- `<input>` is the source textfile. The expected inputs are plaintext for encryption and ciphertext for decryption.
- `<output>` is the destination textfile. The results of the program (whether it be plaintext or ciphertext blocks) will be written to this file.

## Program Output

The program will display two main sections of text as the output.

The "Inputs" section will tell the user the values read in from the provided text files. If the input file was plaintext, it will display the plaintext normally. If the input was ciphertext blocks, the program will print out each block. Additionally, if the mode is `decrypt`, then the program will also print out the padding as an input.

The "Output" section will tell the user the results of the program with the given inputs as arguments. In the case of encryption, the program will display the ciphertext blocks and the padding added to the message in order to generate 64-bit blocks. In the case of decryption, the program will only display the resulting plaintext.

At the very end of output, the program will tell the user where the results where written to, which should be the provided output file.

## Example command prompt inputs

_The following examples are making use of the default values found in the base files provided with the program_

- plaintext.txt
  > The quick brown fox jumps over the lazy dog.

Encryption:
`python3 main.py encrypt plaintext.txt ciphertext.txt`

Decryption:
`python3 main.py decrypt ciphertext.txt output.txt`

## Details on extra files

The `key_gen.py` file contains two functions. One function is the pseudo-random number generator, which will use the seed given by the user to prime the RNG. The second function will then use the RNG to generate numbers in the bounds of 32-bits. This function will continuously generate new numbers if the number is not a prime. This file utilizes `miller_rabin.py` in order to determine if the number is a prime.

The `miller_rabin.py` file contains a python implemenation of the Miller-Rabin Primality Test, which will determine if a number is a prime number. This function is used to ensure that the number generated by the pseudo-random number generator is a prime number, as we can only primes when calculating the public and private keys.

The files `pubkey.txt` and `prikey.txt` contain the public key and private key generated by the program respectively. Once these are generated, the user should no modify them in any way, as they are used for encryption and decryption. At most, `pubkey.txt` can be distributed, but `prikey.txt` should always be kept secure.
